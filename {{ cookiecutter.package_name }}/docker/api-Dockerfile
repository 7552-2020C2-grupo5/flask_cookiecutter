FROM python:3.7.7-stretch
RUN apt-get update && apt-get install -y postgresql-client
RUN pip install poetry
WORKDIR /app
COPY . .
RUN poetry install
RUN poetry run pip install gunicorn
CMD docker/wait-for-postgres.sh && poetry run python cc_playground/manage.py db_create && poetry run python cc_playground/manage.py db upgrade && poetry run gunicorn -w 2 --bind 0.0.0.0:5000 "cc_playground.app:create_app()"
